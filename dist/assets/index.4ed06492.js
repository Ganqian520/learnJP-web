import{r as d,o as p,c as m,a as o,i as T,n as N,u as P,w as U,v as G,b as Q,d as C,F as L,e as H,t as _,f as B,g as X,p as Y,h as Z,j as V,k as ee}from"./vendor.55df7ec2.js";const te=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const y of s.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&i(y)}).observe(document,{childList:!0,subtree:!0});function n(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=n(e);fetch(e.href,s)}};te();async function h(u){return new Promise((l,n)=>{fetch("https://ca448d14-fda5-4d8f-9279-3f4896d8f854.bspapp.com/learnJP",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}).then(e=>e.json()).then(e=>{l(e)}).catch(e=>{alert("\u83B7\u53D6\u6570\u636E\u5931\u8D25\uFF01"+e)})})}var W=(u,l)=>{const n=u.__vccOpts||u;for(const[i,e]of l)n[i]=e;return n};const ne={props:{from:String},emits:["edit","confirm"],setup(u,{emit:l}){let n=d(!1);return(i,e)=>(p(),m("div",{class:"anchor",onMouseenter:e[2]||(e[2]=()=>T(n)?n.value=!0:n=!0),onMouseleave:e[3]||(e[3]=()=>T(n)?n.value=!1:n=!1),style:N({opacity:P(n)?1:0})},[o("div",{class:"button",onClick:e[0]||(e[0]=s=>l("edit"))},"\u7F16\u8F91"),o("div",{class:"button",onClick:e[1]||(e[1]=s=>l("confirm"))},"\u786E\u5B9A")],36))}};var j=W(ne,[["__scopeId","data-v-e924b82e"]]);const oe={class:"container"},se={class:"et"},le={class:"button-div"},ae={emits:["closePop","addCollection"],setup(u,{emit:l}){let n=d("");return(i,e)=>(p(),m("div",oe,[o("div",{class:"mask",onClick:e[0]||(e[0]=()=>l("closePop"))}),o("div",se,[U(o("input",{class:"input",type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>T(n)?n.value=s:n=s)},null,512),[[G,P(n)]]),o("div",le,[o("div",{class:"button",onClick:e[2]||(e[2]=()=>l("closePop"))},"\u53D6\u6D88"),o("div",{class:"button",onClick:e[3]||(e[3]=()=>l("addCollection",P(n)))},"\u786E\u5B9A")])])]))}};var ce=W(ae,[["__scopeId","data-v-08505ace"]]);const re=u=>(Y("data-v-8919cafc"),u=u(),Z(),u),ie={class:"index"},de={class:"sentences scroll border"},ue=["onClick"],ve={class:"indexs scroll border"},pe=["onClick"],fe={class:"index-in"},_e={class:"index-cn"},me={class:"sentence-words"},ye={class:"sentence border"},be=["contenteditable"],he=["contenteditable"],we=["contenteditable"],ge=re(()=>o("div",{class:"bink-w-s"},null,-1)),Ce={class:"words scroll border"},je={class:"index-word"},ke={class:"jp-jm"},Se=["contenteditable"],$e={class:"jp-word"},Le=["contenteditable"],Me={setup(u){const l=d([]),n=d([]),i=d([]),e=d({}),s=d(0),y=d(0),k=d(!1),w=d(!1),b=d(!1),g=d({}),M=d({}),S=d({});let $=-1,E=!1;const F=async()=>{let t=await h({action:"getCollectionName"});t.data&&(l.value=t.data)},x=async()=>{let t=await h({action:"getCollection",collection:l.value[s.value].collection});t.data&&(n.value=t.data[0].sentences)},I=async()=>{if(i.value=[],!e.value.jp)return;let t=e.value.jp.split("\u3000"),c=await h({action:"getWords",list:t});i.value=t.map((v,r)=>{let a={jp:v,cn:"",jm:""},f=c.data.find(A=>{if(A.jp===v)return A},v);return f&&(a.cn=f.cn,a.jm=f.jm),a})},J=()=>{$==-1&&(n.value.push({}),$=n.value.length-1)},O=t=>{y.value=t,E=t==$,e.value=n.value[t]||{},I()},z=async()=>{e.value.jp=g.value.jp.innerHTML,e.value.cn=g.value.cn.innerHTML,e.value.source=g.value.source.innerHTML,E?(await h({action:"addSentence",collection:l.value[s.value].collection,sentence:e.value})).updated==1&&($=-1,E=!1,w.value=!1,alert("\u6DFB\u52A0\u6210\u529F")):(await h({action:"updateSentence",index:y.value,collection:l.value[s.value].collection,sentence:e.value})).updated==1&&(w.value=!1,alert("\u4FEE\u6539\u6210\u529F"))},D=async()=>{let t=[];i.value.forEach((v,r)=>{let a=v.cn!="";v.jm=M.value[`${r}`].innerHTML,v.cn=S.value[`${r}`].innerHTML,S.value[`${r}`].innerHTML!=""&&!a&&t.push(V(v))});let c=await h({action:"addWords",list:t});c.inserted>0&&(b.value=!1,alert(`\u6210\u529F\u6DFB\u52A0${c.inserted}\u6761`))},R=async t=>{i.value[t].jm=M.value[`${t}`].innerHTML,i.value[t].cn=S.value[`${t}`].innerHTML;let c=V(i.value[t]);(await h({action:"updateWord",word:c,jp:c.jp})).updated==1&&(b.value=!1,alert("\u4FEE\u6539\u5355\u8BCD\u6210\u529F\uFF01"))},q=async t=>{(await h({action:"addCollection",collection:t,sentences:[]})).id&&(k.value=!1,alert("\u6DFB\u52A0\u6210\u529F"))},K=async t=>{s.value=t,await x(),O(0)};return Q(async()=>{await F(),await x(),e.value=n.value[y.value],I()}),(t,c)=>{var v;return p(),m(L,null,[o("div",ie,[o("div",de,[C(j,{from:"collection",onEdit:c[0]||(c[0]=()=>k.value=!0)}),(p(!0),m(L,null,H(l.value,(r,a)=>(p(),m("div",{class:"item-sentence hover",key:a,onClick:f=>K(a),style:N({backgroundColor:a==s.value?"rgba(0,0,0,0.2)":""})},_(r.collection),13,ue))),128))]),o("div",ve,[(p(!0),m(L,null,H(n.value,(r,a)=>(p(),m("div",{class:"item-index hover",key:a,onClick:f=>O(a),style:N({backgroundColor:a==y.value?"rgba(0,0,0,0.2)":""})},[o("div",fe,_(a+1),1),o("div",_e,_(r.cn),1)],12,pe))),128)),C(j,{from:"addSentence",onEdit:J})]),o("div",me,[o("div",ye,[C(j,{from:"sentence",onEdit:c[1]||(c[1]=()=>w.value=!w.value),onConfirm:z}),o("div",{class:"st-jp",contenteditable:w.value,ref:r=>g.value.jp=r},_(e.value.jp),9,be),o("div",{class:"st-cn",contenteditable:w.value,ref:r=>g.value.cn=r},_((v=e.value)==null?void 0:v.cn),9,he),o("div",{class:"st-source",contenteditable:w.value,ref:r=>g.value.source=r},_(e.value.source),9,we)]),ge,o("div",Ce,[C(j,{from:"wordAll",style:{left:"0",top:"0","z-index":"1"},onEdit:c[2]||(c[2]=()=>b.value=!b.value),onConfirm:D}),(p(!0),m(L,null,H(i.value,(r,a)=>(p(),m("div",{class:"item-word hover",key:a},[C(j,{from:"wordSingle",onEdit:c[3]||(c[3]=()=>b.value=!b.value),onConfirm:f=>R(a)},null,8,["onConfirm"]),o("div",je,_(a+1),1),o("div",ke,[o("div",{class:"jm-word",contenteditable:b.value,ref_for:!0,ref:f=>M.value[`${a}`]=f},_(r.jm),9,Se),o("div",$e,_(r.jp),1)]),o("div",{class:"cn-word",contenteditable:b.value,ref_for:!0,ref:f=>S.value[`${a}`]=f},_(r.cn),9,Le)]))),128))])])]),k.value?(p(),B(ce,{key:0,onClosePop:c[4]||(c[4]=()=>k.value=!1),onAddCollection:q})):X("",!0)],64)}}};var Ee=W(Me,[["__scopeId","data-v-8919cafc"]]);const Te={setup(u){return(l,n)=>(p(),B(Ee))}};ee(Te).mount("#app");
